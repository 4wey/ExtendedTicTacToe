README.md

# TicTacToe (Qt 6 / C++)

Графическая реализация игры «Крестики-нолики» на C++ с использованием Qt 6 (Widgets). Проект выполнен в формате учебной лабораторной работы с акцентом на разделение логики и интерфейса, а также на расширяемость за счёт независимых игровых режимов.

---

## Возможности

* Режим Classic 3×3 (классические правила)
* Режим Score 10×10 (игра на очки: веса клеток, подсчёт линий, ограничения хода по активной строке/столбцу, партия до 60 ходов)
* Режим Ultimate TicTacToe (поле 9×9, 9 малых полей 3×3, принудительное малое поле для следующего хода)
* Игра: человек vs компьютер, человек vs человек, компьютер vs компьютер
* Переключение языка интерфейса RU/EN
* Окна правил (для Score/Ultimate) и статистики по текущему запуску приложения
* Отображение/скрытие весов клеток в Score Mode (чекбокс в настройках)

---

## Управление в интерфейсе

Слева расположена панель управления:

* Language / Язык: RU или EN
* Mode / Режим:

  * Classic 3×3
  * Score 10×10
  * Ultimate TicTacToe
* Fill / Заполнение (только Score): задаёт ограничения на допустимые ходы (см. описание Score Mode ниже)
* X — компьютер, O — компьютер: включение компьютерного игрока для соответствующей стороны
* Показать веса клеток (только Score): включает отображение веса в правом нижнем углу клетки

Допустимые клетки для хода отображаются через доступность клеток: запрещённые правилами клетки отключаются.

---

## Игровые режимы и правила

### Classic 3×3

* Поле 3×3
* X ходят первыми
* Победа при сборе линии из 3 символов по горизонтали, вертикали или диагонали
* Ничья при заполнении поля без победителя

---

### Score Mode 10×10 (игра на очки)

Параметры режима:

* Поле 10×10
* Длина линии: 4
* Партия завершается после 60 принятых ходов

Веса и стоимость:

* У каждой клетки есть целочисленный вес; в текущей версии используется периодический шаблон 4×4 из значений {2, -2, 1, -1}.
* Ход игрока увеличивает его «расходы» на:

  * вес выбранной клетки
  * стоимость фигуры (зависит от номера хода этим игроком):

    * X: 2, 4, 6, ...
    * O: 3, 5, 7, ...

Начисление очков за линии:

* За каждую сформированную линию длины 4 (горизонталь/вертикаль/диагонали) игрок получает сумму весов клеток этой линии.
* Очки накапливаются по мере игры; одна и та же линия учитывается при её формировании (после хода, который завершил линию).

Итоговый счёт:

* lineScore = сумма всех начислений за линии
* spent = сумма расходов
* total = lineScore − spent
* Победитель определяется по total, при равенстве total фиксируется ничья.

Ограничение доступных ходов (Fill):

* Free — ход в любую свободную клетку
* Top-down rows — доступна только «активная» строка; по мере заполнения строка смещается вниз
* Left-right cols — доступен только «активный» столбец; по мере заполнения столбец смещается вправо
* Random row — выбирается случайная строка, в которой есть свободные клетки
* Random col — выбирается случайный столбец, в котором есть свободные клетки
* Random row OR col — доступны клетки активной строки или активного столбца

Текущая активная строка/столбец отображается в информационном блоке слева.

---

### Ultimate TicTacToe

Основная идея: игра ведётся на большом поле 9×9, разделённом на 9 малых полей 3×3.

Правила хода:

1. Первый ход можно сделать в любую клетку.
2. Следующий игрок обязан ходить в то малое поле, которое соответствует позиции клетки предыдущего хода внутри малого поля.
   Пример: если сходили в «верхний левый» сектор малого поля, то следующий ход должен быть сделан в «верхнем левом» малом поле.
3. Если требуемое малое поле уже выиграно или полностью заполнено, разрешается ход в любое доступное малое поле.

Победа и ничья:

* Малое поле выигрывается по правилам обычных крестиков-ноликов 3×3.
* Побеждает игрок, который выиграл три малых поля подряд (горизонталь/вертикаль/диагональ) на «макро»-поле 3×3.
* Если доступных ходов больше нет и макро-победителя нет — ничья.

Интерфейс дополнительно показывает «активное малое поле» (если ход ограничен).

---

## Компьютерный игрок

Алгоритмы выбора хода зависят от режима:

* Classic 3×3: полный minimax по всем возможным продолжениям партии
* Score 10×10: двухпликовый поиск (ход ИИ + ответ соперника) с оценкой по разнице total
* Ultimate TicTacToe: двухпликовый поиск с эвристической оценкой (учёт выигрышей на макро-уровне и угроз/возможностей внутри малых полей)

Включение компьютера выполняется чекбоксами «X — компьютер» и «O — компьютер».

---

## Архитектура и структура проекта

Ключевые элементы:

* game/ — игровая логика (не зависит от Qt Widgets)

  * game/modes/igame_mode.h — общий интерфейс режима (IGameMode) и структуры данных (MoveOutcome, ScoreSnapshot, GameConfig)
  * game/modes/classic_mode.* — классический режим
  * game/modes/score_mode.* и game/score/score_helpers.* — Score Mode и вспомогательные расчёты
  * game/modes/ultimate_mode.* — Ultimate TicTacToe
  * game/game_engine.* — выбор режима, управление ходами, логика компьютерного игрока
* widgets/boardwidget.* — виджет поля (отрисовка клеток, клики, отображение веса)
* ui/rulesdialog.* — диалог правил
* statsdialog.* — диалог статистики
* mainwindow.* — связывание UI и движка

Расширение проекта новым режимом выполняется через реализацию IGameMode, добавление значения в GameMode и подключение режима в GameEngine и UI.

---

## Сборка и запуск

### Требования

* C++17
* Qt 6 (модули Widgets и Core)
* CMake 3.20+

### Сборка

Из корня проекта:

1. Конфигурация: cmake -S . -B build
   При нестандартной установке Qt может потребоваться указать путь: cmake -S . -B build -DCMAKE_PREFIX_PATH=<путь_к_Qt>
2. Сборка: cmake --build build -j

### Запуск

* macOS / Linux: ./build/game
* Windows: build\game.exe

Примечание: в CMakeLists.txt по умолчанию может быть указан CMAKE_PREFIX_PATH для Homebrew (/opt/homebrew/opt/qt). При иной установке Qt данный параметр следует адаптировать под вашу среду.

---

## Статистика

Окно «Статистика» показывает количество сыгранных партий, побед X, побед O и ничьих в рамках текущего запуска приложения.
